n_negative %>% mutate(t = "negative") %>% select(t,sdg,n)
n_positive %>% mutate(t = "positive") %>% select(t,sdg,n) %>% rbind(n_negative %>% mutate(t = "negative") %>% select(t,sdg,n))
n_positive %>% mutate(t = "positive") %>% select(t,sdg,n) %>% rbind(n_negative %>% mutate(t = "negative") %>% select(t,sdg,n)) %>%
ggplot(aes(x = sdg, y = n, color = t, group = t)) + geom_bar(stat = "identity")
n_positive %>% mutate(t = "positive") %>% select(t,sdg,n) %>% rbind(n_negative %>% mutate(t = "negative") %>% select(t,sdg,n)) %>%
ggplot(aes(x = sdg, y = n, color = t, group = t, fill=t)) + geom_bar(stat = "identity")
short_term_return_sdg_2 = short_term_data_event_sdg %>%
pivot_longer(!c(date,isin,abnormal_ret,'-1':'10',MKT_CAP), names_to = "sdg", values_to = "value") %>%
group_by(isin) %>%
mutate(
#value = na_if(value, 0),
sd = sd(value,na.rm = TRUE),
mean = mean(value, na.rm = TRUE),
threshold = mean + 1*sd
) %>%
mutate(event =
case_when(value > threshold & value > 3 ~ 1,
TRUE
~ 0)
) %>%
rename('0' = abnormal_ret) %>%
select(-c(value,sd,mean,threshold)) %>%
filter(event == 1) %>%
mutate(group = case_when(grepl("pos", sdg) ~ "positive",
grepl("nega", sdg) ~"negative"),
)
n_positive = short_term_return_sdg_2 %>%
filter(group == 'positive') %>%
mutate_at("sdg", str_replace, "_positive_count", "") %>%
mutate_at("sdg", str_replace, "_", " ") %>%
mutate(sdg = factor(sdg, levels = c("sdg 1", "sdg 2","sdg 3","sdg 4","sdg 5","sdg 6","sdg 7","sdg 8","sdg 9","sdg 10","sdg 11",
"sdg 12", "sdg 13","sdg 14","sdg 15","sdg 16","sdg 17"))) %>%
select(-c(event,group)) %>%
pivot_longer(!c(date,isin,sdg), names_to = "period", values_to = "abnormal_ret") %>% na.omit(abnormal_ret) %>%
mutate(period = factor(period, levels = c("-10", "-9","-8","-7","-6","-5","-4","-3","-2","-1","0", "1", "2","3","4","5","6","7","8","9","10"))) %>%
arrange(isin,sdg,date,period) %>%
group_by(isin,sdg,date) %>%
mutate(CAAR = cumsum(abnormal_ret)) %>%
group_by(sdg) %>% filter(period == '0') %>%
summarise(n = n(),
sd = sd(abnormal_ret),
se = sd/sqrt(n),
t = 1.96,
CI=t*se
)
n_negative = short_term_return_sdg %>%
filter(group == 'negative') %>%
mutate_at("sdg", str_replace, "_negative_count", "") %>%
mutate_at("sdg", str_replace, "_", " ") %>%
mutate(sdg = factor(sdg, levels = c("sdg 1", "sdg 2","sdg 3","sdg 4","sdg 5","sdg 6","sdg 7","sdg 8","sdg 9","sdg 10","sdg 11",
"sdg 12", "sdg 13","sdg 14","sdg 15","sdg 16","sdg 17","sdg broad"))) %>%
select(-c(event,group)) %>%
pivot_longer(!c(date,isin,sdg,MKT_CAP), names_to = "period", values_to = "abnormal_ret") %>% na.omit(abnormal_ret) %>%
mutate(period = factor(period, levels = c("-10", "-9","-8","-7","-6","-5","-4","-3","-2","-1","0", "1", "2","3","4","5","6","7","8","9","10"))) %>%
arrange(isin,sdg,date,period) %>%
group_by(isin,sdg,date) %>%
mutate(CAAR = cumsum(abnormal_ret)) %>%
group_by(sdg) %>% filter(period == '0') %>%
summarise(n = n(),
sd = sd(abnormal_ret),
se = sd/sqrt(n),
t = 1.96,
CI=t*se
)
n_negative
n_positive
short_term_return_sdg_2 = short_term_data_event_sdg %>%
pivot_longer(!c(date,isin,abnormal_ret,'-1':'10',MKT_CAP), names_to = "sdg", values_to = "value") %>%
group_by(isin) %>%
mutate(
value = na_if(value, 0),
sd = sd(value,na.rm = TRUE),
mean = mean(value, na.rm = TRUE),
threshold = mean + 1*sd
) %>%
mutate(event =
case_when(value > threshold & value > 3 ~ 1,
TRUE
~ 0)
) %>%
rename('0' = abnormal_ret) %>%
select(-c(value,sd,mean,threshold)) %>%
filter(event == 1) %>%
mutate(group = case_when(grepl("pos", sdg) ~ "positive",
grepl("nega", sdg) ~"negative"),
)
short_term_return_sdg_2 = short_term_data_event_sdg %>%
pivot_longer(!c(date,isin,abnormal_ret,'-1':'10',MKT_CAP), names_to = "sdg", values_to = "value") %>%
group_by(isin) %>%
mutate(
value = na_if(value, 0),
sd = sd(value,na.rm = TRUE),
mean = mean(value, na.rm = TRUE),
threshold = mean + 1*sd
) %>%
mutate(event =
case_when(value > threshold & value > 3 ~ 1,
TRUE
~ 0)
) %>%
rename('0' = abnormal_ret) %>%
select(-c(value,sd,mean,threshold)) %>%
filter(event == 1) %>%
mutate(group = case_when(grepl("pos", sdg) ~ "positive",
grepl("nega", sdg) ~"negative"),
)
n_positive = short_term_return_sdg_2 %>%
filter(group == 'positive') %>%
mutate_at("sdg", str_replace, "_positive_count", "") %>%
mutate_at("sdg", str_replace, "_", " ") %>%
mutate(sdg = factor(sdg, levels = c("sdg 1", "sdg 2","sdg 3","sdg 4","sdg 5","sdg 6","sdg 7","sdg 8","sdg 9","sdg 10","sdg 11",
"sdg 12", "sdg 13","sdg 14","sdg 15","sdg 16","sdg 17"))) %>%
select(-c(event,group)) %>%
pivot_longer(!c(date,isin,sdg), names_to = "period", values_to = "abnormal_ret") %>% na.omit(abnormal_ret) %>%
mutate(period = factor(period, levels = c("-10", "-9","-8","-7","-6","-5","-4","-3","-2","-1","0", "1", "2","3","4","5","6","7","8","9","10"))) %>%
arrange(isin,sdg,date,period) %>%
group_by(isin,sdg,date) %>%
mutate(CAAR = cumsum(abnormal_ret)) %>%
group_by(sdg) %>% filter(period == '0') %>%
summarise(n = n(),
sd = sd(abnormal_ret),
se = sd/sqrt(n),
t = 1.96,
CI=t*se
)
n_positive
n_positive = short_term_return_sdg %>%
filter(group == 'positive') %>%
mutate_at("sdg", str_replace, "_positive_count", "") %>%
mutate_at("sdg", str_replace, "_", " ") %>%
mutate(sdg = factor(sdg, levels = c("sdg 1", "sdg 2","sdg 3","sdg 4","sdg 5","sdg 6","sdg 7","sdg 8","sdg 9","sdg 10","sdg 11",
"sdg 12", "sdg 13","sdg 14","sdg 15","sdg 16","sdg 17"))) %>%
select(-c(event,group)) %>%
pivot_longer(!c(date,isin,sdg), names_to = "period", values_to = "abnormal_ret") %>% na.omit(abnormal_ret) %>%
mutate(period = factor(period, levels = c("-10", "-9","-8","-7","-6","-5","-4","-3","-2","-1","0", "1", "2","3","4","5","6","7","8","9","10"))) %>%
arrange(isin,sdg,date,period) %>%
group_by(isin,sdg,date) %>%
mutate(CAAR = cumsum(abnormal_ret)) %>%
group_by(sdg) %>% filter(period == '0') %>%
summarise(n = n(),
sd = sd(abnormal_ret),
se = sd/sqrt(n),
t = 1.96,
CI=t*se
)
n_positive
short_term_return_sdg = short_term_data_event_sdg %>%
pivot_longer(!c(date,isin,abnormal_ret,'-1':'10',MKT_CAP), names_to = "sdg", values_to = "value") %>%
group_by(isin,sdg) %>%
mutate(
value = na_if(value, 0),
sd = sd(value,na.rm = TRUE),
mean = mean(value, na.rm = TRUE),
threshold = mean + 1*sd
) %>%
mutate(event =
case_when(value > threshold & value > 3 ~ 1,
TRUE
~ 0)
) %>%
rename('0' = abnormal_ret) %>%
select(-c(value,sd,mean,threshold)) %>%
filter(event == 1) %>%
mutate(group = case_when(grepl("pos", sdg) ~ "positive",
grepl("nega", sdg) ~"negative"),
)
short_term_return_sdg_2 %>%
filter(group == 'negative') %>%
mutate_at("sdg", str_replace, "_negative_count", "") %>%
mutate_at("sdg", str_replace, "_", " ") %>%
mutate(sdg = factor(sdg, levels = c("sdg 1", "sdg 2","sdg 3","sdg 4","sdg 5","sdg 6","sdg 7","sdg 8","sdg 9","sdg 10","sdg 11",
"sdg 12", "sdg 13","sdg 14","sdg 15","sdg 16","sdg 17","sdg broad"))) %>%
select(-c(event,group)) %>%
pivot_longer(!c(date,isin,sdg,MKT_CAP), names_to = "period", values_to = "abnormal_ret") %>% na.omit(abnormal_ret) %>%
mutate(period = factor(period, levels = c("-10", "-9","-8","-7","-6","-5","-4","-3","-2","-1","0", "1", "2","3","4","5","6","7","8","9","10"))) %>%
arrange(isin,sdg,date,period) %>%
group_by(isin,sdg,date) %>%
mutate(CAAR = cumsum(abnormal_ret)) %>%
group_by(sdg) %>% filter(period == '0') %>%
summarise(n = n(),
sd = sd(abnormal_ret),
se = sd/sqrt(n),
t = 1.96,
CI=t*se
)
short_term_return_sdg %>%
filter(group == 'negative') %>%
mutate_at("sdg", str_replace, "_negative_count", "") %>%
mutate_at("sdg", str_replace, "_", " ") %>%
mutate(sdg = factor(sdg, levels = c("sdg 1", "sdg 2","sdg 3","sdg 4","sdg 5","sdg 6","sdg 7","sdg 8","sdg 9","sdg 10","sdg 11",
"sdg 12", "sdg 13","sdg 14","sdg 15","sdg 16","sdg 17","sdg broad"))) %>%
select(-c(event,group)) %>%
pivot_longer(!c(date,isin,sdg,MKT_CAP), names_to = "period", values_to = "abnormal_ret") %>% na.omit(abnormal_ret) %>%
mutate(period = factor(period, levels = c("-10", "-9","-8","-7","-6","-5","-4","-3","-2","-1","0", "1", "2","3","4","5","6","7","8","9","10"))) %>%
arrange(isin,sdg,date,period) %>%
group_by(isin,sdg,date) %>%
mutate(CAAR = cumsum(abnormal_ret)) %>%
group_by(sdg) %>% filter(period == '0') %>%
summarise(n = n(),
sd = sd(abnormal_ret),
se = sd/sqrt(n),
t = 1.96,
CI=t*se
)
short_term_return_sdg %>%
filter(group == 'positive') %>%
mutate_at("sdg", str_replace, "_positive_count", "") %>%
mutate_at("sdg", str_replace, "_", " ") %>%
mutate(sdg = factor(sdg, levels = c("sdg 1", "sdg 2","sdg 3","sdg 4","sdg 5","sdg 6","sdg 7","sdg 8","sdg 9","sdg 10","sdg 11",
"sdg 12", "sdg 13","sdg 14","sdg 15","sdg 16","sdg 17"))) %>%
select(-c(event,group)) %>%
pivot_longer(!c(date,isin,sdg), names_to = "period", values_to = "abnormal_ret") %>% na.omit(abnormal_ret) %>%
mutate(period = factor(period, levels = c("-10", "-9","-8","-7","-6","-5","-4","-3","-2","-1","0", "1", "2","3","4","5","6","7","8","9","10"))) %>%
arrange(isin,sdg,date,period) %>%
group_by(isin,sdg,date) %>%
mutate(CAAR = cumsum(abnormal_ret)) %>%
group_by(sdg) %>% filter(period == '0') %>%
summarise(n = n(),
sd = sd(abnormal_ret),
se = sd/sqrt(n),
t = 1.96,
CI=t*se
)
t = short_term_return_sdg %>% # comes from Speciale analysis
filter(group == 'negative') %>%
mutate_at("sdg", str_replace, "_negative_count", "") %>%
mutate_at("sdg", str_replace, "_", " ") %>%
mutate(sdg = factor(sdg, levels = c("sdg 1", "sdg 2","sdg 3","sdg 4","sdg 5","sdg 6","sdg 7","sdg 8","sdg 9","sdg 10","sdg 11",
"sdg 12", "sdg 13","sdg 14","sdg 15","sdg 16","sdg 17"))) %>%
select(-c(event,group)) %>%
pivot_longer(!c(date,isin,sdg,MKT_CAP), names_to = "period", values_to = "abnormal_ret") %>% na.omit(abnormal_ret) %>%
mutate(sdg = as.character(sdg))
all = t %>%
mutate(period = as.numeric(period)) %>%
filter(period >= -10) %>%
filter(period <= 10) %>%
mutate(period = as.factor(period),
sdg = as.factor(sdg)) %>%
mutate(period = factor(period, levels = c("-10","-9","-8","-7","-6","-5","-4","-3","-2","-1","0", "1", "2","3","4","5","6","7","9","10"))) %>% na.omit() %>%
arrange(isin,sdg,date,period) %>%
group_by(isin,sdg,date) %>%
mutate(csum = cumsum(abnormal_ret))
bands = all %>%
group_by(sdg,period) %>%
summarise(n = n(),
sd = sd(csum),
se = sd/sqrt(n),
t = 1.96,
CI=t*se
)
all %>%
group_by(sdg,period) %>%
summarise(CAAR = weighted.mean(csum,MKT_CAP)) %>% ungroup() %>%
left_join(bands, by = c("sdg","period")) %>%
mutate(period = as.character(period)) %>%
filter(period == '10') %>%
#mutate(sdg = factor(sdg, levels = c("People","Planet","Prosperity","Peace","Partnership"))) %>%
mutate(sdg = factor(sdg, levels = c("sdg 1", "sdg 2","sdg 3","sdg 4","sdg 5","sdg 6","sdg 7","sdg 8","sdg 9","sdg 10","sdg 11",
"sdg 12", "sdg 13","sdg 14","sdg 15","sdg 16","sdg 17"))) %>%
ggplot(
aes(x = sdg, y = CAAR, color= sdg,group = sdg, fill = sdg)) +
geom_bar(stat="identity") +
geom_errorbar( aes(x=sdg, ymin=CAAR-CI, ymax=CAAR+CI), colour = "orange", width=0.5, alpha=0.8, size=0.7) +
scale_y_continuous(name ="Abnormal return",
labels = scales::percent) +
#labs(x = "Five Pillars of SDGs") +
theme_bw()+
theme(legend.title = element_blank(),
legend.key.size = unit(0.5, 'cm'),
axis.text.x = element_text(angle=45)) +
theme(legend.position = "none")
t = short_term_return_sdg %>% # comes from Speciale analysis
filter(group == 'positive') %>%
mutate_at("sdg", str_replace, "_positive_count", "") %>%
mutate_at("sdg", str_replace, "_", " ") %>%
mutate(sdg = factor(sdg, levels = c("sdg 1", "sdg 2","sdg 3","sdg 4","sdg 5","sdg 6","sdg 7","sdg 8","sdg 9","sdg 10","sdg 11",
"sdg 12", "sdg 13","sdg 14","sdg 15","sdg 16","sdg 17"))) %>%
select(-c(event,group)) %>%
pivot_longer(!c(date,isin,sdg,MKT_CAP), names_to = "period", values_to = "abnormal_ret") %>% na.omit(abnormal_ret) %>%
mutate(sdg = as.character(sdg)) %>%
mutate(sdg = case_when(
sdg == "sdg 1" | sdg == "sdg 2" | sdg == "sdg 3" | sdg == "sdg 4" | sdg == "sdg 5"  ~ "People",
sdg == "sdg 7" | sdg == "sdg 8" | sdg == "sdg 9" | sdg == "sdg 10" | sdg == "sdg 11"  ~ "Prosperity",
sdg == "sdg 6" | sdg == "sdg 12" | sdg == "sdg 13" | sdg == "sdg 14" | sdg == "sdg 15"  ~ "Planet",
sdg == "sdg 16"  ~ "Peace",
sdg == "sdg 17" ~ "Partnership")
)
all = t %>%
mutate(period = as.numeric(period)) %>%
filter(period >= -10) %>%
filter(period <= 10) %>%
mutate(period = as.factor(period),
sdg = as.factor(sdg)) %>%
mutate(period = factor(period, levels = c("-10","-9","-8","-7","-6","-5","-4","-3","-2","-1","0", "1", "2","3","4","5","6","7","9","10"))) %>% na.omit() %>%
arrange(isin,sdg,date,period) %>%
group_by(isin,sdg,date) %>%
mutate(csum = cumsum(abnormal_ret))
bands = all %>%
group_by(sdg,period) %>%
summarise(n = n(),
sd = sd(csum),
se = sd/sqrt(n),
t = 1.96,
CI=t*se
)
all %>%
group_by(sdg,period) %>%
summarise(CAAR = weighted.mean(csum,MKT_CAP)) %>% ungroup() %>%
left_join(bands, by = c("sdg","period")) %>%
mutate(period = as.character(period)) %>%
filter(period == '10') %>%
#mutate(sdg = factor(sdg, levels = c("People","Planet","Prosperity","Peace","Partnership"))) %>%
mutate(sdg = factor(sdg, levels = c("sdg 1", "sdg 2","sdg 3","sdg 4","sdg 5","sdg 6","sdg 7","sdg 8","sdg 9","sdg 10","sdg 11",
"sdg 12", "sdg 13","sdg 14","sdg 15","sdg 16","sdg 17"))) %>%
ggplot(
aes(x = sdg, y = CAAR, color= sdg,group = sdg, fill = sdg)) +
geom_bar(stat="identity") +
geom_errorbar( aes(x=sdg, ymin=CAAR-CI, ymax=CAAR+CI), colour = "orange", width=0.5, alpha=0.8, size=0.7) +
scale_y_continuous(name ="Abnormal return",
labels = scales::percent) +
#labs(x = "Five Pillars of SDGs") +
theme_bw()+
theme(legend.title = element_blank(),
legend.key.size = unit(0.5, 'cm'),
axis.text.x = element_text(angle=45)) +
theme(legend.position = "none")
all %>%
group_by(sdg,period) %>%
summarise(CAAR = weighted.mean(csum,MKT_CAP)) %>% ungroup() %>%
left_join(bands, by = c("sdg","period")) %>%
mutate(period = as.character(period)) %>%
filter(period == '10')
t = short_term_return_sdg %>% # comes from Speciale analysis
filter(group == 'positive') %>%
mutate_at("sdg", str_replace, "_positive_count", "") %>%
mutate_at("sdg", str_replace, "_", " ") %>%
mutate(sdg = factor(sdg, levels = c("sdg 1", "sdg 2","sdg 3","sdg 4","sdg 5","sdg 6","sdg 7","sdg 8","sdg 9","sdg 10","sdg 11",
"sdg 12", "sdg 13","sdg 14","sdg 15","sdg 16","sdg 17"))) %>%
select(-c(event,group)) %>%
pivot_longer(!c(date,isin,sdg,MKT_CAP), names_to = "period", values_to = "abnormal_ret") %>% na.omit(abnormal_ret) %>%
mutate(sdg = as.character(sdg))
all = t %>%
mutate(period = as.numeric(period)) %>%
filter(period >= -10) %>%
filter(period <= 10) %>%
mutate(period = as.factor(period),
sdg = as.factor(sdg)) %>%
mutate(period = factor(period, levels = c("-10","-9","-8","-7","-6","-5","-4","-3","-2","-1","0", "1", "2","3","4","5","6","7","9","10"))) %>% na.omit() %>%
arrange(isin,sdg,date,period) %>%
group_by(isin,sdg,date) %>%
mutate(csum = cumsum(abnormal_ret))
bands = all %>%
group_by(sdg,period) %>%
summarise(n = n(),
sd = sd(csum),
se = sd/sqrt(n),
t = 1.96,
CI=t*se
)
all %>%
group_by(sdg,period) %>%
summarise(CAAR = weighted.mean(csum,MKT_CAP)) %>% ungroup() %>%
left_join(bands, by = c("sdg","period")) %>%
mutate(period = as.character(period)) %>%
filter(period == '10') %>%
#mutate(sdg = factor(sdg, levels = c("People","Planet","Prosperity","Peace","Partnership"))) %>%
mutate(sdg = factor(sdg, levels = c("sdg 1", "sdg 2","sdg 3","sdg 4","sdg 5","sdg 6","sdg 7","sdg 8","sdg 9","sdg 10","sdg 11",
"sdg 12", "sdg 13","sdg 14","sdg 15","sdg 16","sdg 17"))) %>%
ggplot(
aes(x = sdg, y = CAAR, color= sdg,group = sdg, fill = sdg)) +
geom_bar(stat="identity") +
geom_errorbar( aes(x=sdg, ymin=CAAR-CI, ymax=CAAR+CI), colour = "orange", width=0.5, alpha=0.8, size=0.7) +
scale_y_continuous(name ="Abnormal return",
labels = scales::percent) +
#labs(x = "Five Pillars of SDGs") +
theme_bw()+
theme(legend.title = element_blank(),
legend.key.size = unit(0.5, 'cm'),
axis.text.x = element_text(angle=45)) +
theme(legend.position = "none")
t = short_term_return_sdg %>% # comes from Speciale analysis
filter(group == 'negative') %>%
mutate_at("sdg", str_replace, "_negative_count", "") %>%
mutate_at("sdg", str_replace, "_", " ") %>%
mutate(sdg = factor(sdg, levels = c("sdg 1", "sdg 2","sdg 3","sdg 4","sdg 5","sdg 6","sdg 7","sdg 8","sdg 9","sdg 10","sdg 11",
"sdg 12", "sdg 13","sdg 14","sdg 15","sdg 16","sdg 17"))) %>%
select(-c(event,group)) %>%
pivot_longer(!c(date,isin,sdg,MKT_CAP), names_to = "period", values_to = "abnormal_ret") %>% na.omit(abnormal_ret) %>%
mutate(sdg = as.character(sdg)) %>%
mutate(sdg = case_when(
sdg == "sdg 1" | sdg == "sdg 2" | sdg == "sdg 3" | sdg == "sdg 4" | sdg == "sdg 5"  ~ "People",
sdg == "sdg 7" | sdg == "sdg 8" | sdg == "sdg 9" | sdg == "sdg 10" | sdg == "sdg 11"  ~ "Prosperity",
sdg == "sdg 6" | sdg == "sdg 12" | sdg == "sdg 13" | sdg == "sdg 14" | sdg == "sdg 15"  ~ "Planet",
sdg == "sdg 16"  ~ "Peace",
sdg == "sdg 17" ~ "Partnership")
)
all = t %>%
mutate(period = as.numeric(period)) %>%
filter(period >= -10) %>%
filter(period <= 10) %>%
mutate(period = as.factor(period),
sdg = as.factor(sdg)) %>%
mutate(period = factor(period, levels = c("-10","-9","-8","-7","-6","-5","-4","-3","-2","-1","0", "1", "2","3","4","5","6","7","9","10"))) %>% na.omit() %>%
arrange(isin,sdg,date,period) %>%
group_by(isin,sdg,date) %>%
mutate(csum = cumsum(abnormal_ret))
bands = all %>%
group_by(sdg,period) %>%
summarise(n = n(),
sd = sd(csum),
se = sd/sqrt(n),
t = 1.96,
CI=t*se
)
all %>%
group_by(sdg,period) %>%
summarise(CAAR = weighted.mean(csum,MKT_CAP)) %>% ungroup() %>%
left_join(bands, by = c("sdg","period")) %>%
mutate(period = as.character(period)) %>%
filter(period == '10') %>%
#mutate(sdg = factor(sdg, levels = c("People","Planet","Prosperity","Peace","Partnership"))) %>%
mutate(sdg = factor(sdg, levels = c("sdg 1", "sdg 2","sdg 3","sdg 4","sdg 5","sdg 6","sdg 7","sdg 8","sdg 9","sdg 10","sdg 11",
"sdg 12", "sdg 13","sdg 14","sdg 15","sdg 16","sdg 17"))) %>%
ggplot(
aes(x = sdg, y = CAAR, color= sdg,group = sdg, fill = sdg)) +
geom_bar(stat="identity") +
geom_errorbar( aes(x=sdg, ymin=CAAR-CI, ymax=CAAR+CI), colour = "orange", width=0.5, alpha=0.8, size=0.7) +
scale_y_continuous(name ="Abnormal return",
labels = scales::percent) +
#labs(x = "Five Pillars of SDGs") +
theme_bw()+
theme(legend.title = element_blank(),
legend.key.size = unit(0.5, 'cm'),
axis.text.x = element_text(angle=45)) +
theme(legend.position = "none")
all
all %>%
group_by(sdg,period) %>%
summarise(CAAR = weighted.mean(csum,MKT_CAP)) %>% ungroup() %>%
left_join(bands, by = c("sdg","period")) %>%
mutate(period = as.character(period)) %>%
filter(period == '10') %>%
mutate(sdg = factor(sdg, levels = c("People","Planet","Prosperity","Peace","Partnership"))) %>%
#  mutate(sdg = factor(sdg, levels = c("sdg 1", "sdg 2","sdg 3","sdg 4","sdg 5","sdg 6","sdg 7","sdg 8","sdg 9","sdg 10","sdg 11",
#                                       "sdg 12", "sdg 13","sdg 14","sdg 15","sdg 16","sdg 17"))) %>%
ggplot(
aes(x = sdg, y = CAAR, color= sdg,group = sdg, fill = sdg)) +
geom_bar(stat="identity") +
geom_errorbar( aes(x=sdg, ymin=CAAR-CI, ymax=CAAR+CI), colour = "orange", width=0.5, alpha=0.8, size=0.7) +
scale_y_continuous(name ="Abnormal return",
labels = scales::percent) +
#labs(x = "Five Pillars of SDGs") +
theme_bw()+
theme(legend.title = element_blank(),
legend.key.size = unit(0.5, 'cm'),
axis.text.x = element_text(angle=45)) +
theme(legend.position = "none")
t = short_term_return_sdg_2 %>% # comes from Speciale analysis
filter(group == 'negative') %>%
mutate_at("sdg", str_replace, "_negative_count", "") %>%
mutate_at("sdg", str_replace, "_", " ") %>%
mutate(sdg = factor(sdg, levels = c("sdg 1", "sdg 2","sdg 3","sdg 4","sdg 5","sdg 6","sdg 7","sdg 8","sdg 9","sdg 10","sdg 11",
"sdg 12", "sdg 13","sdg 14","sdg 15","sdg 16","sdg 17"))) %>%
select(-c(event,group)) %>%
pivot_longer(!c(date,isin,sdg,MKT_CAP), names_to = "period", values_to = "abnormal_ret") %>% na.omit(abnormal_ret) %>%
mutate(sdg = as.character(sdg)) %>%
mutate(sdg = case_when(
sdg == "sdg 1" | sdg == "sdg 2" | sdg == "sdg 3" | sdg == "sdg 4" | sdg == "sdg 5"  ~ "People",
sdg == "sdg 7" | sdg == "sdg 8" | sdg == "sdg 9" | sdg == "sdg 10" | sdg == "sdg 11"  ~ "Prosperity",
sdg == "sdg 6" | sdg == "sdg 12" | sdg == "sdg 13" | sdg == "sdg 14" | sdg == "sdg 15"  ~ "Planet",
sdg == "sdg 16"  ~ "Peace",
sdg == "sdg 17" ~ "Partnership")
)
all = t %>%
mutate(period = as.numeric(period)) %>%
filter(period >= -10) %>%
filter(period <= 10) %>%
mutate(period = as.factor(period),
sdg = as.factor(sdg)) %>%
mutate(period = factor(period, levels = c("-10","-9","-8","-7","-6","-5","-4","-3","-2","-1","0", "1", "2","3","4","5","6","7","9","10"))) %>% na.omit() %>%
arrange(isin,sdg,date,period) %>%
group_by(isin,sdg,date) %>%
mutate(csum = cumsum(abnormal_ret))
bands = all %>%
group_by(sdg,period) %>%
summarise(n = n(),
sd = sd(csum),
se = sd/sqrt(n),
t = 1.96,
CI=t*se
)
all %>%
group_by(sdg,period) %>%
summarise(CAAR = weighted.mean(csum,MKT_CAP)) %>% ungroup() %>%
left_join(bands, by = c("sdg","period")) %>%
mutate(period = as.character(period)) %>%
filter(period == '10') %>%
mutate(sdg = factor(sdg, levels = c("People","Planet","Prosperity","Peace","Partnership"))) %>%
#  mutate(sdg = factor(sdg, levels = c("sdg 1", "sdg 2","sdg 3","sdg 4","sdg 5","sdg 6","sdg 7","sdg 8","sdg 9","sdg 10","sdg 11",
#                                       "sdg 12", "sdg 13","sdg 14","sdg 15","sdg 16","sdg 17"))) %>%
ggplot(
aes(x = sdg, y = CAAR, color= sdg,group = sdg, fill = sdg)) +
geom_bar(stat="identity") +
geom_errorbar( aes(x=sdg, ymin=CAAR-CI, ymax=CAAR+CI), colour = "orange", width=0.5, alpha=0.8, size=0.7) +
scale_y_continuous(name ="Abnormal return",
labels = scales::percent) +
#labs(x = "Five Pillars of SDGs") +
theme_bw()+
theme(legend.title = element_blank(),
legend.key.size = unit(0.5, 'cm'),
axis.text.x = element_text(angle=45)) +
theme(legend.position = "none")
