positive = positive_index_10 %>%
transmute("Relative # events" = rel_events/100,type,ESG_risk_category,AAR,CAAR) %>%
pivot_longer(!c(type,ESG_risk_category), names_to = "metric", values_to = "ret") %>%
left_join(
positive_index_10 %>% select(type,ESG_risk_category, "AAR" = SE_AAR, "CAAR" = SE_CAAR) %>%
pivot_longer(!c(type,ESG_risk_category), names_to = "metric", values_to = "SE"), by = c("metric","type","ESG_risk_category")
) %>%
mutate(
low = ret - 1.96*SE,
high = ret + 1.96*SE
)
positive %>% filter(metric == 'CAAR') %>% mutate(ESG_risk_category = factor(ESG_risk_category, levels = c("Low", "Medium","High"))) %>%
group_by(ESG_risk_category) %>%
ggplot(aes(x = type, y = ret,colour = ESG_risk_category, group = ESG_risk_category)) +
geom_ribbon(aes(ymin = low, ymax = high, fill = ESG_risk_category),
alpha=0.1, linetype="dashed", show.legend = FALSE) +
geom_line(size=1) +
theme_bw() +
theme(legend.title = element_blank(),
legend.position="top",
legend.direction = "horizontal") +
scale_y_continuous(name ="Abnormal return",
breaks = pretty_breaks(),
labels = scales::percent) +
scale_x_discrete(name = "Relative time",breaks=c("-10","-5","0","+5","+10"))
negative_index_10 = negative_index_all %>%
mutate(csum = cumsum(value)) %>%
group_by(type, ESG_risk_category) %>% na.omit() %>%
summarise(
rel_events = mean(relative_events, na.rm = TRUE),
AAR = mean(value),
n = n(),
CAAR = mean(csum),
SE_AAR = sd(value, na.rm = TRUE)/sqrt(n()),
SE_CAAR = sd(csum, na.rm = TRUE)/sqrt(n())
)
negative_index_10 = negative_index_all %>%
left_join(ESG_RR, by = "isin") %>%
mutate(csum = cumsum(value)) %>%
group_by(type, ESG_risk_category) %>% na.omit() %>%
summarise(
rel_events = mean(relative_events, na.rm = TRUE),
AAR = mean(value),
n = n(),
CAAR = mean(csum),
SE_AAR = sd(value, na.rm = TRUE)/sqrt(n()),
SE_CAAR = sd(csum, na.rm = TRUE)/sqrt(n())
)
negative = negative_index_10 %>%
transmute("Relative # events" = rel_events/100,type,ESG_risk_category,AAR,CAAR) %>%
pivot_longer(!c(type,ESG_risk_category), names_to = "metric", values_to = "ret") %>%
left_join(
negative_index_10 %>% select(type,ESG_risk_category, "AAR" = SE_AAR, "CAAR" = SE_CAAR) %>%
pivot_longer(!c(type,ESG_risk_category), names_to = "metric", values_to = "SE"), by = c("metric","type","ESG_risk_category")
) %>%
mutate(
low = ret - 1.96*SE,
high = ret + 1.96*SE
)
negative %>% filter(metric == 'CAAR') %>% mutate(ESG_risk_category = factor(ESG_risk_category, levels = c("Low", "Medium","High"))) %>%
group_by(ESG_risk_category) %>%
ggplot(aes(x = type, y = ret,colour = ESG_risk_category, group = ESG_risk_category)) +
geom_ribbon(aes(ymin = low, ymax = high, fill = ESG_risk_category),
alpha=0.1, linetype="dashed", show.legend = FALSE) +
geom_line(size=1) +
theme_bw() +
theme(legend.title = element_blank(),
legend.position="top",
legend.direction = "horizontal") +
scale_y_continuous(name ="Abnormal return",
breaks = pretty_breaks(),
labels = scales::percent) +
scale_x_discrete(name = "Relative time",breaks=c("-10","-5","0","+5","+10"))
negative_index
negative_index = short_term_data_event %>%
select(date,isin,MKT_CAP,"0",contains("-"),contains("+"),neg_event) %>%
select(-c(contains("pos_event_"),contains("neg_event_"))) %>%
filter(neg_event == 1) %>%
select(-neg_event) %>%
pivot_longer(!c(date,isin,MKT_CAP), names_to = "type", values_to = "value") %>%
na.omit(value)
negative_index_events_mean = short_term_data_event %>%
# left_join(ESG_RR, by = "isin") %>% filter(ESG_risk_category == 'High') %>%
select(date,isin,neg_event,norm_negative_sum, contains("neg_event")) %>%
filter(neg_event == 1) %>%
rename('0' = norm_negative_sum) %>%
select(-neg_event) %>%
pivot_longer(!c(date,isin), names_to = "type", values_to = "amount") %>%
mutate_at("type", str_replace, "neg_event_", "") %>%
group_by(isin, date)
negative_index_events = negative_index_events_mean %>%
left_join(negative_index_events_mean %>% filter(type == '0') %>% select(isin,date,"mean" = amount), by = c("isin","date")) %>%
mutate(amount = ifelse(is.na(amount), 0, amount)) %>%
mutate(relative_events = amount/mean)
negative_index_all = negative_index %>%
left_join(negative_index_events %>% select(isin,date,type,relative_events), by = c("isin","date","type")) %>%
mutate(type = factor(type, levels = c("-10", "-9","-8","-7","-6","-5","-4","-3","-2","-1",
"0", "+1", "+2","+3","+4","+5","+6","+7","+8","+9","+10"))) %>%
arrange(isin,date,type) %>%
group_by(isin,date)
negative_index_10 = negative_index_all %>%
left_join(ESG_RR, by = "isin") %>%
mutate(csum = cumsum(value)) %>%
group_by(type, ESG_risk_category) %>% na.omit() %>%
summarise(
rel_events = mean(relative_events, na.rm = TRUE),
AAR = mean(value),
n = n(),
CAAR = mean(csum),
SE_AAR = sd(value, na.rm = TRUE)/sqrt(n()),
SE_CAAR = sd(csum, na.rm = TRUE)/sqrt(n())
)
negative = negative_index_10 %>%
transmute("Relative # events" = rel_events/100,type,ESG_risk_category,AAR,CAAR) %>%
pivot_longer(!c(type,ESG_risk_category), names_to = "metric", values_to = "ret") %>%
left_join(
negative_index_10 %>% select(type,ESG_risk_category, "AAR" = SE_AAR, "CAAR" = SE_CAAR) %>%
pivot_longer(!c(type,ESG_risk_category), names_to = "metric", values_to = "SE"), by = c("metric","type","ESG_risk_category")
) %>%
mutate(
low = ret - 1.96*SE,
high = ret + 1.96*SE
)
negative %>% filter(metric == 'CAAR') %>% mutate(ESG_risk_category = factor(ESG_risk_category, levels = c("Low", "Medium","High"))) %>%
group_by(ESG_risk_category) %>%
ggplot(aes(x = type, y = ret,colour = ESG_risk_category, group = ESG_risk_category)) +
geom_ribbon(aes(ymin = low, ymax = high, fill = ESG_risk_category),
alpha=0.1, linetype="dashed", show.legend = FALSE) +
geom_line(size=1) +
theme_bw() +
theme(legend.title = element_blank(),
legend.position="top",
legend.direction = "horizontal") +
scale_y_continuous(name ="Abnormal return",
breaks = pretty_breaks(),
labels = scales::percent) +
scale_x_discrete(name = "Relative time",breaks=c("-10","-5","0","+5","+10"))
short_term_data_event_negative = short_term_data_event
negative_index = short_term_data_event_negative %>%
select(date,isin,MKT_CAP,"0",contains("-"),contains("+"),neg_event) %>%
select(-c(contains("pos_event_"),contains("neg_event_"))) %>%
filter(neg_event == 1) %>%
select(-neg_event) %>%
pivot_longer(!c(date,isin,MKT_CAP), names_to = "type", values_to = "value") %>%
na.omit(value) %>% left_join(ESG_RR, by = "isin") %>% filter(ESG_risk_category == 'High')
significance_neg_10 = negative_index %>%
mutate(csum = 100*cumsum(value)) %>%
filter(type == '+10')
z.test(significance_neg_10 %>% ungroup() %>% select(csum),y = NULL,
mu = 0,
sigma.x = se_neg_10[[2]],
conf.level = 0.95
)
negative_index_5 = negative_index %>%
mutate(type = as.numeric(as.character(type))) %>%
filter(type >= -5) %>%
filter(type <= 5) %>%
mutate(csum = cumsum(value))
significance_neg_5 = negative_index_5 %>%
mutate(csum = 100*cumsum(value)) %>%
filter(type == 5)
z.test(significance_neg_5 %>% ungroup() %>% select(csum),y = NULL,
mu = 0,
sigma.x = se_neg_5[[2]],
conf.level = 0.95
)
negative_index_2 = negative_index %>%
mutate(type = as.numeric(as.character(type))) %>%
filter(type >= -2) %>%
filter(type <= 2)
significance_neg_2 = negative_index_2 %>%
mutate(csum = 100*cumsum(value)) %>%
filter(type == 2)
z.test(significance_neg_2 %>% ungroup() %>% select(csum),y = NULL,
mu = 0,
sigma.x = se_neg_2[[2]],
conf.level = 0.95
)
negative_index_0 = negative_index %>%
mutate(type = as.numeric(as.character(type))) %>%
filter(type == 0)
significance_neg_0 = negative_index_0 %>%
mutate(csum = 100*cumsum(value)) %>%
filter(type == 0)
se_neg_0 = significance_neg_0 %>%
group_by(type) %>%
summarise(sd = sd(csum, na.rm = TRUE))
z.test(significance_neg_0 %>% ungroup() %>% select(csum),y = NULL,
mu = 0,
sigma.x = se_neg_0[[2]],
conf.level = 0.95
)
ESG_RR <- read.csv("C:/Users/Marti/OneDrive - University of Copenhagen/KU/Speciale/Data behandling/ESG_ratings.csv") %>%
select("isin" = ISIN,ESG_risk_category) %>%
mutate(ESG_risk_category =
case_when(
ESG_risk_category == "Severe" ~ "High",
ESG_risk_category == "Negligible" ~ "Low",
TRUE ~ ESG_risk_category)) %>%
filter(!ESG_risk_category %in% c('No data',"Severe","Negligible")) %>% na.omit()
# Positive
positive_index = short_term_data_event %>%
select(date,isin,MKT_CAP,"0",contains("-"),contains("+"),pos_event) %>%
select(-c(contains("pos_event_"),contains("neg_event_"))) %>%
filter(pos_event == 1) %>%
select(-pos_event) %>%
pivot_longer(!c(date,isin,MKT_CAP), names_to = "type", values_to = "value") %>%
na.omit(value)  %>% left_join(ESG_RR, by = "isin") %>% filter(ESG_risk_category == 'High')
significance_pos_10 = positive_index %>%
mutate(csum = 100*cumsum(value)) %>%
filter(type == '+10')
significance_pos_10 = positive_index %>%
mutate(csum = 100*cumsum(value)) %>%
filter(type == '+10')
se_pos_10 = significance_pos_10 %>%
group_by(type) %>%
summarise(sd = sd(csum, na.rm = TRUE))
z.test(significance_pos_10 %>% ungroup() %>% select(csum),y = NULL,
mu = 0,
sigma.x = se_pos_10[[2]],
conf.level = 0.95
)
positive_index_5 = positive_index %>%
mutate(type = as.numeric(as.character(type))) %>%
filter(type >= -5) %>%
filter(type <= 5)
positive_index_5 = positive_index %>%
mutate(type = as.numeric(as.character(type))) %>%
filter(type >= -5) %>%
filter(type <= 5)
# Test of significance
significance_pos_5 = positive_index_5 %>%
mutate(csum = 100*cumsum(value)) %>%
filter(type == 5)
se_pos_5 = significance_pos_5 %>%
group_by(type) %>%
summarise(sd = sd(csum, na.rm = TRUE))
z.test(significance_pos_5 %>% ungroup() %>% select(csum),y = NULL,
mu = 0,
sigma.x = se_pos_5[[2]],
conf.level = 0.95
)
positive_index_2 = positive_index %>%
mutate(type = as.numeric(as.character(type))) %>%
filter(type >= -2) %>%
filter(type <= 2)
# Test of significance
significance_pos_2 = positive_index_2 %>%
mutate(csum = 100*cumsum(value)) %>%
filter(type == 2)
se_pos_2 = significance_pos_2 %>%
group_by(type) %>%
summarise(sd = sd(csum, na.rm = TRUE))
z.test(significance_pos_2 %>% ungroup() %>% select(csum),y = NULL,
mu = 0,
sigma.x = se_pos_2[[2]],
conf.level = 0.95
)
positive_index_0 = positive_index %>%
mutate(type = as.numeric(as.character(type))) %>%
filter(type == 0)
# Test of significance
significance_pos_0 = positive_index_0 %>%
mutate(csum = 100*cumsum(value)) %>%
filter(type == 0)
se_pos_0 = significance_pos_0 %>%
group_by(type) %>%
summarise(sd = sd(csum, na.rm = TRUE))
z.test(significance_pos_0 %>% ungroup() %>% select(csum),y = NULL,
mu = 0,
sigma.x = se_pos_0[[2]],
conf.level = 0.95
)
negative_index = short_term_data_event_negative %>%
select(date,isin,MKT_CAP,"0",contains("-"),contains("+"),neg_event) %>%
select(-c(contains("pos_event_"),contains("neg_event_"))) %>%
filter(neg_event == 1) %>%
select(-neg_event) %>%
pivot_longer(!c(date,isin,MKT_CAP), names_to = "type", values_to = "value") %>%
na.omit(value) %>% left_join(ESG_RR, by = "isin") %>% filter(ESG_risk_category == 'Medium')
negative_index_2 = negative_index %>%
mutate(type = as.numeric(as.character(type))) %>%
filter(type >= -2) %>%
filter(type <= 2)
significance_neg_2 = negative_index_2 %>%
mutate(csum = 100*cumsum(value)) %>%
filter(type == 2)
significance_neg_2 = negative_index_2 %>%
mutate(csum = 100*cumsum(value)) %>%
filter(type == 2)
se_neg_2 = significance_neg_2 %>%
group_by(type) %>%
summarise(sd = sd(csum, na.rm = TRUE))
se_neg_2 = significance_neg_2 %>%
group_by(type) %>%
summarise(sd = sd(csum, na.rm = TRUE))
z.test(significance_neg_2 %>% ungroup() %>% select(csum),y = NULL,
mu = 0,
sigma.x = se_neg_2[[2]],
conf.level = 0.95
)
negative_index = short_term_data_event_negative %>%
select(date,isin,MKT_CAP,"0",contains("-"),contains("+"),neg_event) %>%
select(-c(contains("pos_event_"),contains("neg_event_"))) %>%
filter(neg_event == 1) %>%
select(-neg_event) %>%
pivot_longer(!c(date,isin,MKT_CAP), names_to = "type", values_to = "value") %>%
na.omit(value) %>% left_join(ESG_RR, by = "isin") %>% filter(ESG_risk_category == 'Medium')
negative_index_events_mean = short_term_data_event %>%
select(date,isin,neg_event,norm_negative_sum, contains("neg_event")) %>%
filter(neg_event == 1) %>%
rename('0' = norm_negative_sum) %>%
select(-neg_event) %>%
pivot_longer(!c(date,isin), names_to = "type", values_to = "amount") %>%
mutate_at("type", str_replace, "neg_event_", "") %>%
group_by(isin, date)
negative_index_events = negative_index_events_mean %>%
left_join(negative_index_events_mean %>% filter(type == '0') %>% select(isin,date,"mean" = amount), by = c("isin","date")) %>%
mutate(amount = ifelse(is.na(amount), 0, amount)) %>%
mutate(relative_events = amount/mean)
negative_index_all = negative_index %>%
left_join(negative_index_events %>% select(isin,date,type,relative_events), by = c("isin","date","type")) %>%
mutate(type = factor(type, levels = c("-10", "-9","-8","-7","-6","-5","-4","-3","-2","-1",
"0", "+1", "+2","+3","+4","+5","+6","+7","+8","+9","+10"))) %>%
arrange(isin,date,type) %>%
group_by(isin,date)
negative_index_10 = negative_index_all %>%
left_join(ESG_RR, by = "isin") %>%
mutate(csum = cumsum(value)) %>%
group_by(type, ESG_risk_category) %>% na.omit() %>%
summarise(
rel_events = mean(relative_events, na.rm = TRUE),
AAR = mean(value),
n = n(),
CAAR = mean(csum),
SE_AAR = sd(value, na.rm = TRUE)/sqrt(n()),
SE_CAAR = sd(csum, na.rm = TRUE)/sqrt(n())
)
negative_index = short_term_data_event_negative %>%
select(date,isin,MKT_CAP,"0",contains("-"),contains("+"),neg_event) %>%
select(-c(contains("pos_event_"),contains("neg_event_"))) %>%
filter(neg_event == 1) %>%
select(-neg_event) %>%
pivot_longer(!c(date,isin,MKT_CAP), names_to = "type", values_to = "value") %>%
na.omit(value) %>% left_join(ESG_RR, by = "isin")
negative_index = short_term_data_event_negative %>%
select(date,isin,MKT_CAP,"0",contains("-"),contains("+"),neg_event) %>%
select(-c(contains("pos_event_"),contains("neg_event_"))) %>%
filter(neg_event == 1) %>%
select(-neg_event) %>%
pivot_longer(!c(date,isin,MKT_CAP), names_to = "type", values_to = "value") %>%
na.omit(value)
negative_index_events_mean = short_term_data_event_negative %>%
select(date,isin,neg_event,norm_negative_sum, contains("neg_event")) %>%
filter(neg_event == 1) %>%
rename('0' = norm_negative_sum) %>%
select(-neg_event) %>%
pivot_longer(!c(date,isin), names_to = "type", values_to = "amount") %>%
mutate_at("type", str_replace, "neg_event_", "") %>%
group_by(isin, date)
negative_index_events = negative_index_events_mean %>%
left_join(negative_index_events_mean %>% filter(type == '0') %>% select(isin,date,"mean" = amount), by = c("isin","date")) %>%
mutate(amount = ifelse(is.na(amount), 0, amount)) %>%
mutate(relative_events = amount/mean)
negative_index_all = negative_index %>%
left_join(negative_index_events %>% select(isin,date,type,relative_events), by = c("isin","date","type")) %>%
mutate(type = factor(type, levels = c("-10", "-9","-8","-7","-6","-5","-4","-3","-2","-1",
"0", "+1", "+2","+3","+4","+5","+6","+7","+8","+9","+10"))) %>%
arrange(isin,date,type) %>%
group_by(isin,date)
negative_index_all %>%
left_join(ESG_RR, by = "isin") %>%
mutate(csum = cumsum(value)) %>%
group_by(type, ESG_risk_category)
negative_index_10 = negative_index_all %>%
left_join(ESG_RR, by = "isin") %>%
mutate(csum = cumsum(value)) %>%
group_by(type, ESG_risk_category) %>% na.omit() %>%
summarise(
rel_events = mean(relative_events, na.rm = TRUE),
AAR = mean(value),
n = n(),
CAAR = mean(csum),
SE_AAR = sd(value, na.rm = TRUE)/sqrt(n()),
SE_CAAR = sd(csum, na.rm = TRUE)/sqrt(n())
)
negative = negative_index_10 %>%
transmute("Relative # events" = rel_events/100,type,ESG_risk_category,AAR,CAAR) %>%
pivot_longer(!c(type,ESG_risk_category), names_to = "metric", values_to = "ret") %>%
left_join(
negative_index_10 %>% select(type,ESG_risk_category, "AAR" = SE_AAR, "CAAR" = SE_CAAR) %>%
pivot_longer(!c(type,ESG_risk_category), names_to = "metric", values_to = "SE"), by = c("metric","type","ESG_risk_category")
) %>%
mutate(
low = ret - 1.96*SE,
high = ret + 1.96*SE
)
negative %>% filter(metric == 'AAR') %>% mutate(ESG_risk_category = factor(ESG_risk_category, levels = c("Low", "Medium","High"))) %>%
group_by(ESG_risk_category) %>%
ggplot(aes(x = type, y = ret,colour = ESG_risk_category, group = ESG_risk_category)) +
geom_ribbon(aes(ymin = low, ymax = high, fill = ESG_risk_category),
alpha=0.1, linetype="dashed", show.legend = FALSE) +
geom_line(size=1) +
theme_bw() +
theme(legend.title = element_blank(),
legend.position="top",
legend.direction = "horizontal") +
scale_y_continuous(name ="Abnormal return",
breaks = pretty_breaks(),
labels = scales::percent) +
scale_x_discrete(name = "Relative time",breaks=c("-10","-5","0","+5","+10"))
negative %>% filter(metric == 'CAAR') %>% mutate(ESG_risk_category = factor(ESG_risk_category, levels = c("Low", "Medium","High"))) %>%
group_by(ESG_risk_category) %>%
ggplot(aes(x = type, y = ret,colour = ESG_risk_category, group = ESG_risk_category)) +
geom_ribbon(aes(ymin = low, ymax = high, fill = ESG_risk_category),
alpha=0.1, linetype="dashed", show.legend = FALSE) +
geom_line(size=1) +
theme_bw() +
theme(legend.title = element_blank(),
legend.position="top",
legend.direction = "horizontal") +
scale_y_continuous(name ="Abnormal return",
breaks = pretty_breaks(),
labels = scales::percent) +
scale_x_discrete(name = "Relative time",breaks=c("-10","-5","0","+5","+10"))
ESG_RR <- read.csv("C:/Users/Marti/OneDrive - University of Copenhagen/KU/Speciale/Data behandling/ESG_ratings.csv") %>%
select("isin" = ISIN,ESG_risk_category) %>%
# mutate(ESG_risk_category =
#          case_when(
#   ESG_risk_category == "Severe" ~ "High",
#   ESG_risk_category == "Negligible" ~ "Low",
#   TRUE ~ ESG_risk_category)) %>%
filter(!ESG_risk_category %in% c('No data',"Severe","Negligible")) %>% na.omit()
negative_index_10 = negative_index_all %>%
left_join(ESG_RR, by = "isin") %>%
mutate(csum = cumsum(value)) %>%
group_by(type, ESG_risk_category) %>% na.omit() %>%
summarise(
rel_events = mean(relative_events, na.rm = TRUE),
AAR = mean(value),
n = n(),
CAAR = mean(csum),
SE_AAR = sd(value, na.rm = TRUE)/sqrt(n()),
SE_CAAR = sd(csum, na.rm = TRUE)/sqrt(n())
)
negative = negative_index_10 %>%
transmute("Relative # events" = rel_events/100,type,ESG_risk_category,AAR,CAAR) %>%
pivot_longer(!c(type,ESG_risk_category), names_to = "metric", values_to = "ret") %>%
left_join(
negative_index_10 %>% select(type,ESG_risk_category, "AAR" = SE_AAR, "CAAR" = SE_CAAR) %>%
pivot_longer(!c(type,ESG_risk_category), names_to = "metric", values_to = "SE"), by = c("metric","type","ESG_risk_category")
) %>%
mutate(
low = ret - 1.96*SE,
high = ret + 1.96*SE
)
negative %>% filter(metric == 'CAAR') %>% mutate(ESG_risk_category = factor(ESG_risk_category, levels = c("Low", "Medium","High"))) %>%
group_by(ESG_risk_category) %>%
ggplot(aes(x = type, y = ret,colour = ESG_risk_category, group = ESG_risk_category)) +
geom_ribbon(aes(ymin = low, ymax = high, fill = ESG_risk_category),
alpha=0.1, linetype="dashed", show.legend = FALSE) +
geom_line(size=1) +
theme_bw() +
theme(legend.title = element_blank(),
legend.position="top",
legend.direction = "horizontal") +
scale_y_continuous(name ="Abnormal return",
breaks = pretty_breaks(),
labels = scales::percent) +
scale_x_discrete(name = "Relative time",breaks=c("-10","-5","0","+5","+10"))
negative %>% filter(metric == 'AAR') %>% mutate(ESG_risk_category = factor(ESG_risk_category, levels = c("Low", "Medium","High"))) %>%
group_by(ESG_risk_category) %>%
ggplot(aes(x = type, y = ret,colour = ESG_risk_category, group = ESG_risk_category)) +
geom_ribbon(aes(ymin = low, ymax = high, fill = ESG_risk_category),
alpha=0.1, linetype="dashed", show.legend = FALSE) +
geom_line(size=1) +
theme_bw() +
theme(legend.title = element_blank(),
legend.position="top",
legend.direction = "horizontal") +
scale_y_continuous(name ="Abnormal return",
breaks = pretty_breaks(),
labels = scales::percent) +
scale_x_discrete(name = "Relative time",breaks=c("-10","-5","0","+5","+10"))
negative %>% filter(metric == 'CAAR') %>% mutate(ESG_risk_category = factor(ESG_risk_category, levels = c("Low", "Medium","High"))) %>%
group_by(ESG_risk_category) %>%
ggplot(aes(x = type, y = ret,colour = ESG_risk_category, group = ESG_risk_category)) +
geom_ribbon(aes(ymin = low, ymax = high, fill = ESG_risk_category),
alpha=0.1, linetype="dashed", show.legend = FALSE) +
geom_line(size=1) +
theme_bw() +
theme(legend.title = element_blank(),
legend.position="top",
legend.direction = "horizontal") +
scale_y_continuous(name ="Abnormal return",
breaks = pretty_breaks(),
labels = scales::percent) +
scale_x_discrete(name = "Relative time",breaks=c("-10","-5","0","+5","+10"))
negative %>% filter(metric == 'AAR') %>% mutate(ESG_risk_category = factor(ESG_risk_category, levels = c("Low", "Medium","High"))) %>%
group_by(ESG_risk_category) %>%
ggplot(aes(x = type, y = ret,colour = ESG_risk_category, group = ESG_risk_category)) +
geom_ribbon(aes(ymin = low, ymax = high, fill = ESG_risk_category),
alpha=0.1, linetype="dashed", show.legend = FALSE) +
geom_line(size=1) +
theme_bw() +
theme(legend.title = element_blank(),
legend.position="top",
legend.direction = "horizontal") +
scale_y_continuous(name ="Abnormal return",
breaks = pretty_breaks(),
labels = scales::percent) +
scale_x_discrete(name = "Relative time",breaks=c("-10","-5","0","+5","+10"))
